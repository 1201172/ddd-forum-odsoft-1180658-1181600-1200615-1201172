plugins {
    id "com.github.node-gradle.node" version "7.0.0"
}

node {
    // Version of node to use.
    version = '12.22.12'

    // Version of npm to use.
    npmVersion = '6.14.16'

    // If true, it will download node using above parameters.
    // If false, it will try to use globally installed node.
    download = true
}

task runApiTests(type: Exec) {
    doLast {
        exec {
            commandLine 'npm', 'run', 'test'
        }
        exec {
            commandLine 'npm', 'run', 'test:dev'
        }
        exec {
            commandLine 'npm', 'run', 'test:api'
        }
    }

    doLast {
        println "Npm commands executed: db:delete:dev, db:create:dev, migrate:dev, jest"
    }
}

// Define task dependencies to ensure the commands run in order
runApiTests.dependsOn 'npmInstall'

// Optionally, specify a description for the task
runApiTests.description = 'Run npm commands in order: db:delete:dev, db:create:dev, migrate:dev, jest'